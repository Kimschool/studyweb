
CREATE TABLE `user` (
	`id` BIGINT(10) NOT NULL AUTO_INCREMENT,
	`userId` VARCHAR(20) NOT NULL COLLATE 'utf8mb4_general_ci',
	`password` VARCHAR(150) NOT NULL COLLATE 'utf8mb4_general_ci',
	`username` VARCHAR(30) NOT NULL COLLATE 'utf8mb4_general_ci',
	`role` VARCHAR(10) NOT NULL COLLATE 'utf8mb4_general_ci',
	`create_date` TIMESTAMP NOT NULL DEFAULT current_timestamp(),
	PRIMARY KEY (`id`) USING BTREE,
	UNIQUE INDEX `userId` (`userId`) USING BTREE
);

CREATE TABLE `studys` (
	`id` BIGINT(10) NOT NULL AUTO_INCREMENT,
	`study_name` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_general_ci',
	`category` VARCHAR(10) NULL DEFAULT NULL COLLATE 'utf8mb4_general_ci',
	`study_detail` VARCHAR(500) NULL DEFAULT NULL COLLATE 'utf8mb4_general_ci',
	`writer_userid` VARCHAR(30) NULL DEFAULT NULL COLLATE 'utf8mb4_general_ci',
	`filepath` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8mb4_general_ci',
	`start_date` TIMESTAMP NULL DEFAULT NULL,
	`end_date` TIMESTAMP NULL DEFAULT NULL,
	`create_date` TIMESTAMP NULL DEFAULT NULL,
	`update_date` TIMESTAMP NULL DEFAULT NULL,
	PRIMARY KEY (`id`) USING BTREE
);

CREATE TABLE `study_application` (
	`id` BIGINT(10) NOT NULL AUTO_INCREMENT,
	`user_id` BIGINT(10) NOT NULL,
	`study_id` BIGINT(10) NOT NULL,
	`application_date` TIMESTAMP NOT NULL DEFAULT current_timestamp(),
	PRIMARY KEY (`id`) USING BTREE,
	INDEX `study_application_ibfk_1` (`user_id`) USING BTREE,
	INDEX `study_application_ibfk_2` (`study_id`) USING BTREE,
	CONSTRAINT `study_application_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON UPDATE RESTRICT ON DELETE RESTRICT,
	CONSTRAINT `study_application_ibfk_2` FOREIGN KEY (`study_id`) REFERENCES `studys` (`id`) ON UPDATE RESTRICT ON DELETE RESTRICT
);

CREATE TABLE `post` (
	`id` BIGINT(10) NOT NULL AUTO_INCREMENT,
	`title` VARCHAR(50) NULL DEFAULT NULL COLLATE 'utf8mb4_general_ci',
	`contents` VARCHAR(500) NULL DEFAULT NULL COLLATE 'utf8mb4_general_ci',
	`category_id` BIGINT(10) NULL DEFAULT NULL,
	`author_id` BIGINT(10) NULL DEFAULT NULL,
	`view_count` INT(11) NULL DEFAULT '0',
	`create_date` TIMESTAMP NOT NULL DEFAULT current_timestamp(),
	PRIMARY KEY (`id`) USING BTREE,
	INDEX `author_id` (`author_id`) USING BTREE,
	INDEX `category_id` (`category_id`) USING BTREE,
	CONSTRAINT `FK_post_post_category` FOREIGN KEY (`category_id`) REFERENCES `post_category` (`id`) ON UPDATE NO ACTION ON DELETE NO ACTION,
	CONSTRAINT `FK_post_user` FOREIGN KEY (`author_id`) REFERENCES `user` (`id`) ON UPDATE SET NULL ON DELETE SET NULL
);

CREATE TABLE `comment` (
	`id` BIGINT(10) NOT NULL AUTO_INCREMENT,
	`post_id` BIGINT(10) NULL DEFAULT '0',
	`author_id` BIGINT(10) NULL DEFAULT '0',
	`contents` VARCHAR(200) NULL DEFAULT NULL COLLATE 'utf8mb4_general_ci',
	`create_date` TIMESTAMP NOT NULL DEFAULT current_timestamp(),
	PRIMARY KEY (`id`) USING BTREE,
	INDEX `post_id` (`post_id`) USING BTREE,
	INDEX `author_id` (`author_id`) USING BTREE,
	CONSTRAINT `FK__post` FOREIGN KEY (`post_id`) REFERENCES `post` (`id`) ON UPDATE CASCADE ON DELETE CASCADE,
	CONSTRAINT `FK_comment_user` FOREIGN KEY (`author_id`) REFERENCES `user` (`id`) ON UPDATE SET NULL ON DELETE SET NULL
);

CREATE TABLE `post_like` (
	`id` BIGINT(10) NOT NULL AUTO_INCREMENT,
	`post_id` BIGINT(10) NOT NULL,
	`user_id` BIGINT(10) NOT NULL,
	`created_at` TIMESTAMP NOT NULL DEFAULT current_timestamp(),
	PRIMARY KEY (`id`) USING BTREE,
	INDEX `post_id` (`post_id`) USING BTREE,
	INDEX `user_id` (`user_id`) USING BTREE,
	CONSTRAINT `post_like_ibfk_1` FOREIGN KEY (`post_id`) REFERENCES `post` (`id`) ON UPDATE CASCADE ON DELETE CASCADE,
	CONSTRAINT `post_like_ibfk_2` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE `post_category` (
	`id` BIGINT(10) NOT NULL AUTO_INCREMENT,
	`name` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_general_ci',
	PRIMARY KEY (`id`) USING BTREE,
	UNIQUE INDEX `name` (`name`) USING BTREE
);